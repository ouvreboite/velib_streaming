<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="609px" preserveAspectRatio="none" style="width:558px;height:609px;" version="1.1" viewBox="0 0 558 609" width="558px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="205" x="167.75" y="16.708">High level topology</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="140" x="200.25" y="37.6611">(Kafka Stream)</text><!--MD5=[d1148e26bc769c05cd12af7143d7e113]
entity stationAvailabilityClient--><rect fill="#FF7F50" height="52.5938" style="stroke: #FFFFFF; stroke-width: 1.5;" width="193" x="237" y="48.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="83" x="292" y="71.9014">«producer»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="247" y="88.1982">stationAvailabilityClient</text><!--MD5=[5d3aefac5a38ef6bf20cf283a9bd6866]
entity stationAvailabilities--><rect fill="#DCDCDC" height="52.5938" style="stroke: #FFFFFF; stroke-width: 1.5;" width="162" x="252.5" y="162.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="53" x="307" y="185.9014">«topic»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="142" x="262.5" y="202.1982">stationAvailabilities</text><!--MD5=[5a4ea3b7a5127cf9394d1d1b6348545f]
entity stationUpdates--><rect fill="#DCDCDC" height="52.5938" style="stroke: #FFFFFF; stroke-width: 1.5;" width="130" x="268.5" y="292.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="53" x="307" y="315.9014">«topic»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="278.5" y="332.1982">stationUpdates</text><!--MD5=[024ee7ce38d555eed7c30878f4f92ef8]
entity hourlyStationStats--><rect fill="#DCDCDC" height="52.5938" style="stroke: #FFFFFF; stroke-width: 1.5;" width="155" x="7" y="427.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="53" x="58" y="450.4014">«topic»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="17" y="466.6982">hourlyStationStats</text><!--MD5=[2a436f2442a7fdfad9fe8adda98188e5]
entity stationStatus--><rect fill="#DCDCDC" height="52.5938" style="stroke: #FFFFFF; stroke-width: 1.5;" width="117" x="353" y="545.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="53" x="385" y="568.9014">«topic»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97" x="363" y="585.1982">stationStatus</text><!--MD5=[2c5d1e5187b13ce3ce5fa5d47e0aec5d]
entity bikesLocked--><rect fill="#DCDCDC" height="52.5938" style="stroke: #FFFFFF; stroke-width: 1.5;" width="111" x="173" y="545.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="53" x="202" y="568.9014">«topic»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="183" y="585.1982">bikesLocked</text><!--MD5=[1f2111737cb25c69fa86958715e3ab1c]
entity station_hourly_statistics--><path d="M197,432.9063 C197,422.9063 294.5,422.9063 294.5,422.9063 C294.5,422.9063 392,422.9063 392,432.9063 L392,474.5 C392,484.5 294.5,484.5 294.5,484.5 C294.5,484.5 197,484.5 197,474.5 L197,432.9063 " fill="#FF7F50" style="stroke: #FFFFFF; stroke-width: 1.5;"/><path d="M197,432.9063 C197,442.9063 294.5,442.9063 294.5,442.9063 C294.5,442.9063 392,442.9063 392,432.9063 " fill="none" style="stroke: #FFFFFF; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="84" x="252.5" y="459.9014">«database»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="207" y="476.1982">station_hourly_statistics</text><!--MD5=[75490d6191340c74c8d49034062afe57]
link stationAvailabilityClient to stationAvailabilities--><path d="M333.5,102.1013 C333.5,118.6062 333.5,140.1373 333.5,157.5643 " fill="none" id="stationAvailabilityClient-to-stationAvailabilities" style="stroke: #00BFFF; stroke-width: 1.0;"/><polygon fill="#00BFFF" points="333.5,162.8313,337.5,153.8313,333.5,157.8313,329.5,153.8313,333.5,162.8313" style="stroke: #00BFFF; stroke-width: 1.0;"/><!--MD5=[957c203bdf5e2e668136ac123e4ffce6]
link stationAvailabilities to stationUpdates--><path d="M333.5,216.0013 C333.5,236.6692 333.5,265.8163 333.5,287.7323 " fill="none" id="stationAvailabilities-to-stationUpdates" style="stroke: #00BFFF; stroke-width: 1.0;"/><polygon fill="#00BFFF" points="333.5,292.8553,337.5,283.8553,333.5,287.8553,329.5,283.8553,333.5,292.8553" style="stroke: #00BFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="334.5" y="258.9731">drop duplicates and compute diff</text><!--MD5=[6d9e0b5f0a2c938bc7e6fc8f98669f57]
link stationUpdates to hourlyStationStats--><path d="M279.717,346.0243 C260.868,355.2123 239.634,365.8022 220.5,375.9063 C191.015,391.4763 158.498,409.8423 132.655,424.7313 " fill="none" id="stationUpdates-to-hourlyStationStats" style="stroke: #00BFFF; stroke-width: 1.0;"/><polygon fill="#00BFFF" points="128.239,427.2793,138.0336,426.247,132.5701,424.7809,134.0362,419.3173,128.239,427.2793" style="stroke: #00BFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="221.5" y="388.9731">aggregate on a 1-hour window</text><!--MD5=[2ddc62395fe4c70a5dc81e58c0a1bf96]
link hourlyStationStats to bikesLocked--><path d="M116.101,480.4723 C138.798,498.8343 169.412,523.6029 192.96,542.6529 " fill="none" id="hourlyStationStats-to-bikesLocked" style="stroke: #00BFFF; stroke-width: 1.0;"/><polygon fill="#00BFFF" points="196.972,545.8995,192.492,537.1285,193.0852,542.7541,187.4596,543.3473,196.972,545.8995" style="stroke: #00BFFF; stroke-width: 1.0;"/><!--MD5=[d92ec79c179565965658fa45c06bf08d]
link hourlyStationStats to station_hourly_statistics--><path d="M162.02,453.9063 C171.935,453.9063 181.85,453.9063 191.766,453.9063 " fill="none" id="hourlyStationStats-to-station_hourly_statistics" style="stroke: #00BFFF; stroke-width: 1.0;"/><polygon fill="#00BFFF" points="196.951,453.9063,187.951,449.9063,191.951,453.9063,187.951,457.9063,196.951,453.9063" style="stroke: #00BFFF; stroke-width: 1.0;"/><!--MD5=[6b6b122bee130e2732e393fff8e41b00]
link stationUpdates to stationStatus--><path d="M394.328,346.0683 C406.006,353.8833 416.7,363.7243 423.5,375.9063 C452.566,427.9783 436.177,500.4521 422.971,540.9391 " fill="none" id="stationUpdates-to-stationStatus" style="stroke: #00BFFF; stroke-width: 1.0;"/><polygon fill="#00BFFF" points="421.38,545.7144,428.02,538.4404,422.9606,540.9708,420.4303,535.9114,421.38,545.7144" style="stroke: #00BFFF; stroke-width: 1.0;"/><!--MD5=[7085279c076eb2e44dbd612810135458]
link station_hourly_statistics to stationStatus--><path d="M324.63,484.9083 C342.256,502.4577 364.414,524.5214 381.94,541.9725 " fill="none" id="station_hourly_statistics-to-stationStatus" style="stroke: #00BFFF; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#00BFFF" points="385.833,545.8489,382.2785,536.6638,382.2902,542.3206,376.6333,542.3323,385.833,545.8489" style="stroke: #00BFFF; stroke-width: 1.0;"/><!--MD5=[83ee0aa762ab11d5fb0ff7da436c5aab]
link station_hourly_statistics to bikesLocked--><path d="M277.503,484.9083 C267.728,502.1628 255.481,523.781 245.676,541.0887 " fill="none" id="station_hourly_statistics-to-bikesLocked" style="stroke: #00BFFF; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#00BFFF" points="242.979,545.8489,250.8958,539.9901,245.4437,541.4986,243.9353,536.0465,242.979,545.8489" style="stroke: #00BFFF; stroke-width: 1.0;"/><!--MD5=[6542ce97bcde26cb764b7bb1219deb61]
@startuml
title
<b>High level topology</b>
(Kafka Stream)
end title

rectangle stationAvailabilityClient <<producer>>
rectangle stationAvailabilities <<topic>>
rectangle stationUpdates <<topic>>
rectangle hourlyStationStats<<topic>>
rectangle stationStatus <<topic>>
rectangle bikesLocked <<topic>>
database station_hourly_statistics <<database>>


stationAvailabilityClient - -> stationAvailabilities 
stationAvailabilities - -> stationUpdates : drop duplicates and compute diff
stationUpdates - -> hourlyStationStats : aggregate on a 1-hour window
hourlyStationStats - -> bikesLocked
hourlyStationStats -> station_hourly_statistics
stationUpdates - -> stationStatus
station_hourly_statistics ..> stationStatus
station_hourly_statistics ..> bikesLocked

skinparam rectangle{
    backgroundColor<<topic>> Gainsboro
    backgroundColor<<table>> Gainsboro
    backgroundColor<<producer>> Coral
    backgroundColor<<consumer>> Coral
    borderColor<<topic>> transparent
    borderColor<<table>> transparent
    borderColor<<producer>> transparent
    borderColor<<consumer>> transparent
}

skinparam database{ 
   backgroundColor<<database>> Coral
   borderColor transparent
}

skinparam{
   ArrowColor DeepSkyBlue
   shadowing false
}
@enduml

PlantUML version 1.2020.17beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>